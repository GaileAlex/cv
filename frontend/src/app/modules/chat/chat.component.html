<app-menu></app-menu>

<div class="text-center p_100_top">
    <h2>–ì–æ–ª–æ—Å–æ–≤–æ–π —á–∞—Ç —Å –º–æ–¥–µ–ª—å—é</h2>

    <div class="p_50">
        <p-dropdown
                [options]="sessions"
                [(ngModel)]="selectedSessionId"
                optionLabel="description"
                optionValue="id"
                placeholder="–í—ã–±–µ—Ä–∏—Ç–µ —Å–µ—Å—Å–∏—é"
                class="w-full md:w-56"
                (onChange)="onSelectSession($event.value)">
        </p-dropdown>
    </div>

    <div class="p_50">
        <p-dropdown
                [options]="languageOptions"
                [(ngModel)]="selectedLang"
                optionLabel="name"
                optionValue="code"
                placeholder="–Ø–∑—ã–∫"
                class="w-full md:w-56"
                (onChange)="updateLangAndVoices($event)">
        </p-dropdown>
    </div>

    <div class="p_50">
        <p-dropdown
                [options]="voiceOptions"
                [(ngModel)]="selectedVoiceIndex"
                placeholder="–ì–æ–ª–æ—Å"
                class="w-full md:w-56">
        </p-dropdown>
    </div>

    <div class="text-center p_50">
        <div class="container">
            <textarea
                    class="text-center p_50"
                    [(ngModel)]="promptText"
                    rows="3"
                    placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ üé§">
            </textarea>
        </div>
    </div>

    <div class="p_50">
        <button pButton style="margin-right: 5px" label="üì® –û—Ç–ø—Ä–∞–≤–∏—Ç—å" (click)="sendPrompt()"></button>
        <button *ngIf="!isRecognizing"
                pButton
                style="margin-right: 5px"
                class="p-button-success"
                label="üé§ –ì–æ–≤–æ—Ä–∏—Ç—å"
                (click)="startVoice()">
        </button>

        <button *ngIf="isRecognizing"
                pButton
                style="margin-right: 5px"
                class="p-button-danger"
                label="‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å"
                (click)="stopVoiceInput()">
        </button>
        <button pButton style="margin-right: 5px" label="üîá –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–∑–≤—É—á–∫—É" (click)="stopSpeaking()"></button>
        <button pButton label="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —á–∞—Ç" (click)="clearChat()"></button>
    </div>

    <div class="history" id="chatHistory">
        <div *ngFor="let entry of chatHistory" [ngClass]="entry.role">
            <span>{{ entry.role === 'user' ? 'üßë: ' : 'ü§ñ: ' }}</span>
            <span [innerHTML]="formatText(entry.text)"></span>
        </div>
    </div>
</div>

<app-footer></app-footer>
